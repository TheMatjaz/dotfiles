# My scripts
alias markdown="perl /Applications/scripts/Markdown.pl --html4tags"
alias countcode="bash /Applications/scripts/count_lines_of_java_code.sh"
alias gh-pages="bash /Applications/scripts/javadoc_after_build_run.sh"
alias numerus="java -jar ~/Development/NetBeansProjects/Numerus/target/Numerus-*-jar-with-dependencies.jar"

# Directories
alias db="cd ~/Dropbox"
alias dev="cd ~/Development"
alias tmp="cd /tmp"

# Create and enter the directory
function mkcd() {
    mkdir -p $@ && cd $_
}

# Get size of a directory or file
function size() {
    du -shck "$@" | sort -rn | awk '
        function human(x) {
            s="kMGTEPYZ";
            while (x>=1000 && length(s)>1) {
                x/=1024
                s=substr(s,2)
            }
            return int(x+0.5) substr(s,1,1)
        }
        {gsub(/^[0-9]+/, human($1)); print}'
    }
    
# Pretty print json
alias json='python -m json.tool'

# Top sordted by CPU usage on OS X   
alias top="top -o cpu"

# Hide/show all desktop icons (useful when presenting)
alias hidedesktop="defaults write com.apple.finder CreateDesktop -bool false && killall Finder"
alias showdesktop="defaults write com.apple.finder CreateDesktop -bool true && killall Finder"

# Start Emacsclient and eventually also the daemon server, if down
alias e="emacsclient -t -a ''"

# Android debugger
alias adb="/Users/matjaz/Library/Android/sdk/platform-tools/adb"

# Others
alias fuck='eval $(thefuck $(fc -ln -1 | tail -n 1)); fc -R'
alias pip='pip3'
alias psql="'/Applications/Postgres.app/Contents/Versions/9.4/bin'/psql -p5432"

# IP addresses
alias wanip="dig +short myip.opendns.com @resolver1.opendns.com"
alias lanip="ipconfig getifaddr en0"

# Recursively delete `.DS_Store` files from current directory
alias dscleanup="find . -type f -name '*.DS_Store' -ls -delete"

# Empty the Trash on all mounted volumes and the main HDD.
# Also, clear Appleâ€™s System Logs to improve shell startup speed.
# Finally, clear download history from quarantine. https://mths.be/bum
alias emptytrash="sudo rm -rfv /Volumes/*/.Trashes; sudo rm -rfv ~/.Trash"
alias emptylogsquarantine="sudo rm -rfv /private/var/log/asl/*.asl; sqlite3 ~/Library/Preferences/com.apple.LaunchServices.QuarantineEventsV* 'delete from LSQuarantineEvent'; sqlite3 ~/Library/Mail/V2/MailData/Envelope\ Index vacuum" 

# Open man page as PDF
function manpdf() {
    man -t "${1}" | open -f -a /Applications/Preview.app/
}

# Extra many types of compressed packages
# Credit: http://nparikh.org/notes/zshrc.txt
extract() {
    if [ -f "$1" ]; then
        case "$1" in
            *.tar.bz2)  tar -jxvf "$1"                        ;;
            *.tar.gz)   tar -zxvf "$1"                        ;;
            *.bz2)      bunzip2 "$1"                          ;;
            *.dmg)      hdiutil mount "$1"                    ;;
            *.gz)       gunzip "$1"                           ;;
            *.tar)      tar -xvf "$1"                         ;;
            *.tbz2)     tar -jxvf "$1"                        ;;
            *.tgz)      tar -zxvf "$1"                        ;;
            *.zip)      unzip "$1"                            ;;
            *.ZIP)      unzip "$1"                            ;;
            *.pax)      cat "$1" | pax -r                     ;;
            *.pax.Z)    uncompress "$1" --stdout | pax -r     ;;
            *.Z)        uncompress "$1"                       ;;
            *) echo "'$1' cannot be extracted/mounted via extract()" ;;
        esac
    else
        echo "'$1' is not a valid file to extract"
    fi
}

# apply zshrc, zsh_aliases and zsh_path changes
alias zshrc="source ~/.zshrc"

# Change directory to the current Finder directory
function cdfinder() {
    target=`osascript -e 'tell application "Finder" to if (count of Finder windows) > 0 then get POSIX path of (target of front Finder window as text)'`
    if [ "$target" != "" ]; then
        cd "$target"; pwd
    else
        echo 'No Finder window found' >&2
    fi
}


# Operative system dependant shortcuts
case $(uname) in
    'Darwin')
        alias mc=". /usr/local/Cellar/midnight-commander/*/libexec/mc/mc-wrapper.sh"
        ;;
    'Linux')
        alias mc=". /usr/share/mc/bin/mc-wrapper.sh"
        ;;
esac

# Call pdftk, if installed, to compress a PDF file passing through postscript
function pdfcompress() {
    which pdf2ps 2>&1 > /dev/null
    if [ $? = 0 ]; then
        filename=$1
        filename=${filename%.*}
        echo -n "pdf -> ps"
        pdf2ps "$filename.pdf" "/tmp/$filename.ps"
        echo -n " -> pdf compressed"
        ps2pdf /tmp/$filename.ps $filename\ compressed.pdf
        echo "   Done!"
        rm "/tmp/$filename.ps"
    else
        echo "PdfTK not installed. Cannot use pdf2ps and ps2pdf."
    fi
}
